<!DOCTYPE html>
<html
  lang="en"
  xmlns:th="http://www.thymeleaf.org"
  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  layout:decorate="~{layout/layout}"
>
  <head>
    <title>Board Register</title>
  </head>
  <body>
    <div layout:fragment="content">
      <div class="container-sm mt-5">
        <h3>Board Register</h3>
        <form
          th:action="@{/board/register}"
          th:object="${boardVO}"
          method="post"
          class="mt-3"
          enctype="multipart/form-data"
        >
          <div class="mb-3">
            <label for="title" class="form-label">Title</label>
            <input
              type="text"
              class="form-control"
              id="title"
              th:field="*{title}"
              placeholder="Enter title"
            />
          </div>
          <div class="mb-3">
            <label for="content" class="form-label">Content</label>
            <textarea
              class="form-control"
              id="content"
              th:field="*{content}"
              rows="5"
              placeholder="Enter content"
            ></textarea>
          </div>
          <div class="mb-3">
            <label for="writer" class="form-label">Writer</label>
            <input
              type="text"
              class="form-control"
              id="writer"
              th:value="${#authentication.name}"
              name="writer"
              readonly
            />
          </div>
          <!-- Secret Toggle -->
          <div class="mb-3">
            <label class="form-label">Secret Post</label>
            <div class="form-check">
              <input
                class="form-check-input"
                type="radio"
                name="isSecret"
                id="public"
                value="false"
                checked
                onclick="togglePassword(false)"
              />
              <label class="form-check-label" for="public">Public</label>
            </div>
            <div class="form-check">
              <input
                class="form-check-input"
                type="radio"
                name="isSecret"
                id="secret"
                value="true"
                onclick="togglePassword(true)"
              />
              <label class="form-check-label" for="secret">Private</label>
            </div>
          </div>

          <div class="mb-3" id="passwordDiv" style="display: none">
            <label for="password" class="form-label">Password</label>
            <input
              type="password"
              class="form-control"
              id="password"
              th:field="*{password}"
              placeholder="Password"
            />
          </div>

          <script>
            function togglePassword(isSecret) {
              const passDiv = document.getElementById("passwordDiv");
              const passwordInput = document.getElementById("password");
              if (isSecret) {
                passDiv.style.display = "block";
                passwordInput.setAttribute("required", "required");
              } else {
                passDiv.style.display = "none";
                passwordInput.removeAttribute("required");
                passwordInput.value = ""; // Clear password if public
              }
            }
          </script>

          <!-- File Input -->
          <div class="mb-3">
            <label for="file" class="form-label">Files</label>
            <input
              type="file"
              class="form-control"
              name="files"
              id="files"
              multiple
            />
          </div>
          <button type="submit" class="btn btn-primary">Register</button>
          <a href="/board/list" class="btn btn-secondary">Cancel</a>
        </form>
      </div>
    </div>
  </body>
</html>
